# Χ”ΧΧ§Χ Χ” ΧΧ”Χ™Χ¨Χ” - Rate Limiting

## ΧΧ” Χ”Χ©ΧΧ Χ”?

Χ”Χ•Χ΅Χ¤Χ Χ• 3 Χ¨Χ›Χ™Χ‘Χ™Χ Χ—Χ“Χ©Χ™Χ ΧΧΧΆΧ¨Χ›Χ:

1. **Rate Limiter** - ΧΧ’Χ‘Χ™Χ ΧΧ΅Χ¤Χ¨ Χ‘Χ§Χ©Χ•Χ ΧΧ“Χ§Χ”
2. **Search Cache** - Χ©Χ•ΧΧ¨ ΧΧ•Χ¦ΧΧ•Χ Χ—Χ™Χ¤Χ•Χ© Χ‘Χ–Χ™Χ›Χ¨Χ•Χ
3. **Error Page** - Χ“Χ£ Χ©Χ’Χ™ΧΧ•Χ ΧΧ©Χ•Χ¤Χ¨

## Χ§Χ‘Χ¦Χ™Χ Χ—Χ“Χ©Χ™Χ

```
utils/
  β”β”€β”€ rate_limiter.py      # ΧΧ Χ’Χ Χ•Χ Rate Limiting
  β””β”€β”€ search_cache.py      # ΧΧ Χ’Χ Χ•Χ Caching

tests/
  β””β”€β”€ test_rate_limiting.py  # Χ‘Χ“Χ™Χ§Χ•Χ ΧΧ•ΧΧ•ΧΧΧ™Χ•Χ

docs/
  β””β”€β”€ RATE_LIMITING_SOLUTION.md  # ΧΧ™ΧΆΧ•Χ“ ΧΧΧ
```

## Χ§Χ‘Χ¦Χ™Χ Χ©Χ©Χ•Χ Χ•

- `routes.py` - Χ”Χ•Χ΅Χ¤Χ Rate Limiting Χ•Caching ΧΧ—Χ™Χ¤Χ•Χ©
- `config.py` - Χ”Χ•Χ΅Χ¤Χ Χ”Χ’Χ“Χ¨Χ•Χ Rate Limiting
- `templates/error.html` - ΧΆΧ™Χ¦Χ•Χ‘ ΧΧ©Χ•Χ¤Χ¨

## Χ‘Χ“Χ™Χ§Χ” ΧΧ”Χ™Χ¨Χ”

### 1. Χ”Χ¨Χ¥ ΧΧ Χ”Χ‘Χ“Χ™Χ§Χ•Χ

```bash
python tests/test_rate_limiting.py
```

ΧΧΧ•Χ¨ ΧΧ”Χ“Χ¤Χ™Χ΅:
```
β… All tests passed!
```

### 2. Χ”Χ¨Χ¥ ΧΧ Χ”Χ©Χ¨Χ

```bash
python app.py
```

### 3. Χ‘Χ“Χ•Χ§ Rate Limiting

Χ¤ΧΧ— ΧΧ Χ”Χ“Χ¤Χ“Χ¤Χ Χ•Χ Χ΅Χ” ΧΧ‘Χ¦ΧΆ 15 Χ—Χ™Χ¤Χ•Χ©Χ™Χ Χ΅ΧΧ ΧΧ™Χ™Χ ΧΧ”Χ™Χ¨Χ™Χ.
Χ”Χ—Χ™Χ¤Χ•Χ© Χ”-11 ΧΧΧ•Χ¨ ΧΧ”Χ¦Χ™Χ’ Χ”Χ•Χ“ΧΆΧ Χ©Χ’Χ™ΧΧ”:

```
Χ—Χ¨Χ’Χ ΧΧΧ’Χ‘ΧΧ Χ”Χ—Χ™Χ¤Χ•Χ© Χ”Χ΅ΧΧ ΧΧ™. 
ΧΧ•ΧΧ¨Χ•Χ 10 Χ‘Χ§Χ©Χ•Χ Χ‘Χ“Χ§Χ”.
```

### 4. Χ‘Χ“Χ•Χ§ Caching

1. Χ‘Χ¦ΧΆ Χ—Χ™Χ¤Χ•Χ© Χ΅ΧΧ ΧΧ™: "Χ¦Χ“Χ§"
2. Χ‘Χ¦ΧΆ Χ©Χ•Χ‘ ΧΧ ΧΧ•ΧΧ• Χ”Χ—Χ™Χ¤Χ•Χ©
3. Χ‘Χ“Χ•Χ§ ΧΧ Χ”ΧΧ•Χ’Χ™Χ - ΧΧΧ•Χ¨ ΧΧ”Χ•Χ¤Χ™ΧΆ:
   ```
   Cache hit for query: Χ¦Χ“Χ§
   ```

## Χ”Χ’Χ“Χ¨Χ•Χ

Χ Χ™ΧΧ ΧΧ©Χ Χ•Χ ΧΧ Χ”Χ”Χ’Χ“Χ¨Χ•Χ Χ‘-`config.py`:

```python
# Rate Limiting Configuration
RATE_LIMIT_SEARCH = 20      # Χ‘Χ§Χ©Χ•Χ ΧΧ“Χ§Χ” - Χ—Χ™Χ¤Χ•Χ© Χ¨Χ’Χ™Χ
RATE_LIMIT_SEMANTIC = 10    # Χ‘Χ§Χ©Χ•Χ ΧΧ“Χ§Χ” - Χ—Χ™Χ¤Χ•Χ© Χ΅ΧΧ ΧΧ™
RATE_LIMIT_WINDOW = 60      # Χ—ΧΧ•Χ Χ–ΧΧ Χ‘Χ©Χ Χ™Χ•Χ
```

## ΧΧ” Χ§Χ•Χ¨Χ” ΧΧΧ—Χ•Χ¨Χ™ Χ”Χ§ΧΧΆΧ™Χ?

### Χ—Χ™Χ¤Χ•Χ© Χ¨Χ’Χ™Χ (ΧΧ§Χ΅Χ Χ—Χ•Χ¤Χ©Χ™, ΧΧ’Χ™Χ•Χ):
```
Χ‘Χ§Χ©Χ” β†’ Rate Limit (20/Χ“Χ§Χ”) β†’ Χ—Χ™Χ¤Χ•Χ© Χ‘ΧΧ΅Χ“ Χ ΧΧ•Χ Χ™Χ β†’ ΧΧ•Χ¦ΧΧ•Χ
```

### Χ—Χ™Χ¤Χ•Χ© Χ΅ΧΧ ΧΧ™:
```
Χ‘Χ§Χ©Χ” β†’ Rate Limit (10/Χ“Χ§Χ”) β†’ Χ‘Χ“Χ™Χ§Χ Cache
                                    β†“
                          Χ ΧΧ¦Χ?  β†  ΧΧ Χ ΧΧ¦Χ
                            β†“           β†“
                        ΧΧ•Χ¦ΧΧ•Χ    Χ—Χ™Χ¤Χ•Χ© + Χ©ΧΧ™Χ¨Χ” Χ‘-Cache
                                        β†“
                                    ΧΧ•Χ¦ΧΧ•Χ
```

## Χ™ΧΧ¨Χ•Χ Χ•Χ

β… **Χ”Χ’Χ Χ” ΧΧ¤Χ Χ™ Χ©Χ™ΧΧ•Χ© Χ™ΧΧ¨** - ΧΧ•Χ ΧΆ ΧΆΧ•ΧΧ΅ ΧΆΧ Χ”Χ©Χ¨Χ  
β… **Χ‘Χ™Χ¦Χ•ΧΆΧ™Χ ΧΧ©Χ•Χ¤Χ¨Χ™Χ** - Cache ΧΧ¤Χ—Χ™Χ Χ–ΧΧ ΧΧ’Χ•Χ‘Χ” Χ‘-90%+  
β… **Χ—Χ•Χ•Χ™Χ™Χ ΧΧ©ΧΧΧ© ΧΧ•Χ‘Χ”** - Χ”Χ•Χ“ΧΆΧ•Χ Χ©Χ’Χ™ΧΧ” Χ‘Χ¨Χ•Χ¨Χ•Χ Χ‘ΧΆΧ‘Χ¨Χ™Χ  
β… **Χ§Χ ΧΧΧ—Χ–Χ•Χ§Χ”** - Χ§Χ•Χ“ Χ¤Χ©Χ•Χ Χ•ΧΧ•Χ“Χ•ΧΧ¨Χ™  

## Χ©ΧΧΧ•Χ Χ Χ¤Χ•Χ¦Χ•Χ

### Χ©: Χ”ΧΧ Χ”-Cache Χ Χ©ΧΧ¨ Χ‘Χ™Χ Χ”Χ¤ΧΆΧΧ•Χ Χ©Χ Χ”Χ©Χ¨Χ?
Χ: ΧΧ, Χ”-Cache Χ ΧΧ¦Χ Χ‘Χ–Χ™Χ›Χ¨Χ•Χ Χ•Χ ΧΧ—Χ§ Χ›Χ©Χ”Χ©Χ¨Χ Χ Χ›Χ‘Χ”. ΧΧ΅Χ‘Χ™Χ‘Χ Production ΧΧ•ΧΧΧ¥ ΧΧ”Χ©ΧΧΧ© Χ‘-Redis.

### Χ©: ΧΧ™Χ ΧΧ Χ™ Χ™Χ›Χ•Χ ΧΧ Χ§Χ•Χ ΧΧ Χ”-Cache?
Χ: Χ”Χ•Χ΅Χ£ route Χ—Χ“Χ©:
```python
@main.route('/admin/clear-cache', methods=['POST'])
@login_is_required
def clear_cache():
    from utils.search_cache import search_cache
    search_cache.clear()
    return "Cache cleared!"
```

### Χ©: ΧΧ™Χ ΧΧ Χ™ Χ™Χ›Χ•Χ ΧΧ¨ΧΧ•Χ Χ΅ΧΧΧ™Χ΅ΧΧ™Χ§Χ•Χ?
Χ: Χ”Χ•Χ΅Χ£ route:
```python
@main.route('/admin/stats')
@login_is_required
def cache_stats():
    from utils.search_cache import search_cache
    return jsonify(search_cache.get_stats())
```

### Χ©: ΧΧ” Χ§Χ•Χ¨Χ” ΧΧ Χ™Χ© ΧΧ™ Χ›ΧΧ” Χ©Χ¨ΧΧ™Χ?
Χ: Χ”Χ¤ΧΧ¨Χ•Χ Χ”Χ Χ•Χ›Χ—Χ™ ΧΆΧ•Χ‘Χ“ Χ¨Χ§ ΧΧ©Χ¨Χ Χ‘Χ•Χ“Χ“. ΧΧ΅Χ‘Χ™Χ‘Χ” ΧΆΧ ΧΧ΅Χ¤Χ¨ Χ©Χ¨ΧΧ™Χ Χ¦Χ¨Χ™Χ:
- Redis ΧRate Limiting ΧΧ©Χ•ΧΧ£
- Redis ΧCache ΧΧ©Χ•ΧΧ£

## Χ©Χ“Χ¨Χ•Χ’ Χ-Production

Χ›Χ©ΧΧ”Χ™Χ” ΧΧ•Χ›Χ ΧΧ΅Χ‘Χ™Χ‘Χ Production, Χ”ΧΧ§Χ:

```bash
pip install flask-limiter redis
```

Χ•ΧΆΧ“Χ›Χ ΧΧ Χ”Χ§Χ•Χ“ ΧΧ”Χ©ΧΧΧ© Χ‘-Flask-Limiter + Redis.

---

**Χ–ΧΧ Χ”ΧΧ§Χ Χ”:** 0 Χ“Χ§Χ•Χ (Χ”Χ›Χ Χ›Χ‘Χ¨ ΧΧ•ΧΧ§Χ!)  
**Χ–ΧΧ Χ‘Χ“Χ™Χ§Χ”:** 2 Χ“Χ§Χ•Χ  
**Χ–ΧΧ Χ”Χ‘Χ Χ”:** 5 Χ“Χ§Χ•Χ  

π‰ **ΧΧ•Χ›Χ ΧΧ©Χ™ΧΧ•Χ©!**
